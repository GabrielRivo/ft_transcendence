PRAGMA journal_mode = WAL;
PRAGMA foreign_keys = ON;

CREATE TABLE IF NOT EXISTS generalChatHistory(
    msgId INTEGER PRIMARY KEY AUTOINCREMENT,
    userId INTEGER,
    username VARCHAR(255 ) DEFAULT 'Unknown',
    msgContent VARCHAR(500),
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP
);


CREATE TABLE IF NOT EXISTS privateChatHistory(
    msgId INTEGER PRIMARY KEY AUTOINCREMENT,
    userId1 INTEGER NOT NULL,
    userId2 INTEGER NOT NULL,
    senderId INTEGER NOT NULL,
    msgContent VARCHAR(500),
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE IF NOT EXISTS privateGroup ( --delete
    groupId INTEGER PRIMARY KEY AUTOINCREMENT,
    name TEXT NOT NULL,
    ownerId INTEGER NOT NULL,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE IF NOT EXISTS groupMembers (
    groupId INTEGER NOT NULL,
    userId INTEGER NOT NULL,
    joined_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    PRIMARY KEY (groupId, userId),
    FOREIGN KEY (groupId) REFERENCES privateGroup(groupId) ON DELETE CASCADE
);

CREATE TABLE IF NOT EXISTS groupChatHistory(
    msgId INTEGER PRIMARY KEY,
    groupId INTEGER NOT NULL,
    userId INTEGER,
    msgContent VARCHAR(5000),
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (groupId) REFERENCES privateGroup(groupId) ON DELETE CASCADE
);

CREATE TABLE IF NOT EXISTS tournamentChatHistory(
    chatId INTEGER PRIMARY KEY,
    msgId INTEGER NOT NULL,
    userId INTEGER NOT NULL,
    msgContent VARCHAR(5000),
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP
);


CREATE TABLE IF NOT EXISTS tournamentChatLink(
    tournamentId INTEGER PRIMARY KEY,
    chatId INTEGER NOT NULL,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP
);
